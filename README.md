# 公共说明和错误码

## 1. 运营商接入说明

### 基本信息

- **API提供方（我方）**：游戏厂商方 (`{APIURL}`)
- **接入方**：运营商 (`{OPURL}`)
- **服务器时区**：UTC+0（接入时需注意数据统计的时区计算）
- **成功标识**：接口返回 `code = 0` 表示成功

### 账号获取流程

1. 运营商提交开户申请。
2. 审核通过后，游戏厂商方提供运营商后台账号。
3. 运营商登录后台获取以下信息：
   - `{APIURL}`：接口地址
   - `AppID`：商户号（商户名称）
   - `AppSecret`：商户编码

---

## 2. 公共参数与签名算法

所有请求头（Header）中必须包含以下公共参数：

| 参数             | 所处位置   | 必填  | 类型     | 说明                    |
|:-------------- |:------ |:--- |:------ |:--------------------- |
| `X-Sign`       | header | 是   | string | 签名算法见 签名算法及示例         |
| `X-Request-Id` | header | 是   | string | 唯一，建议格式：UTC时间戳\_6位随机码 |
| `X-Appid`      | header | 是   | string | 商户号                   |

### 签名算法及示例

**签名算法规则：**

$$
\text{sign} = \text{MD5}(\text{X-Request-Id} + \text{body 中的原始 JSON 字符串} + \text{签名密钥 key})
$$

**注意：** 这里的 body 中的 JSON 字符串必须是请求中最原始的 body 中的字符，不能使用 JSON 包转出来之后的字符。最终签名必须使用小写输出。

#### 示例数据

| 类型                    | 值                                      |
|:--------------------- |:-------------------------------------- |
| **请求 URL**            | `{APIURL}/api/v1/game/list`            |
| **请求方式**              | POST                                   |
| **Content-Type**      | `application/json; charset=utf-8`      |
| **X-Appid**           | `qwe456_USD_1`                         |
| **X-Request-Id**      | `1760060260227_224451`                 |
| **签名密钥 Key**          | `970cb4e4-9ed3-4fc0-802c-8dbedb8b5e85` |
| **请求 Body (原始 JSON)** | `{"Language":"en"}`                    |
| **期望 X-Sign**         | `847f08989098ed696e2b8ac085e0e808`     |

**备注：** 此示例签名与下面MD5结果不一致，请以MD5结果为准。

#### 提供的 MD5 计算结果（注意：此处的输入字符串与上述示例请求 Body 不匹配，请以文档提供的数据为准）

| 项                          | 值                                                                                                                                                                  |
|:-------------------------- |:------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **需要 MD5 加密的字符串**          | `trace_id=dhf1aboc1iio{"player_logon_token":"b27cfe9b-f01c-11ee-a0b5-000c2901d9cc","account_id":"1002402","timestamp":1711971655}39a6581c31ef3203a22edb2daa2ab6d1` |
| **最终加密出来的 MD5 字符串 (sign)** | `e3f8dc79e875e46f6755ef540c2d24f3`                                                                                                                                 |

---

## 3. 接口协议规范

### 请求规范

- **Content-Type**：`application/json;charset=UTF-8`
- **请求方法**：POST
- **时间格式**：UTC时间戳

### 响应规范

- **HTTP状态码**：200 表示 HTTP 访问正常，其他状态码表示链路异常。
- **Content-Type**：`application/json;charset=UTF-8`
- **响应格式**：`{"code": int, "error": string, "data": object}`

#### 响应字段说明

| 参数名     | 类型      | 说明                       |
|:------- |:------- |:------------------------ |
| `code`  | integer | 错误编码，`0` 表示成功，非 `0` 表示失败 |
| `error` | string  | 错误信息描述                   |
| `data`  | object  | 返回的业务数据（有错误不会生效）         |

#### 成功响应示例

```json
{
  "code": 0,
  "error": "",
  "data": {
    "glist": [
      {
        "gameid": "9",
        "name": "mine",
        "platform": "1"
      }
    ]
  }
}
---
```
